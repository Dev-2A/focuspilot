<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>FocusPilot</title>
  <link rel="stylesheet" href="/static/style.css" />
</head>
<body>
  <header class="wrap header">
    <div class="brand">
      <h1>FocusPilot</h1>
      <p class="muted">ì˜¤ëŠ˜: <b>{{ date }}</b> Â· <a href="/report">ë¦¬í¬íŠ¸</a></p>
    </div>

    <!-- âœ… ë‹¤ìŒ í–‰ë™ 1ì¤„ ê°€ì´ë“œ (í´ë¦­í•˜ë©´ í•´ë‹¹ ì¹´ë“œë¡œ ì´ë™) -->
    <div class="statusBar" id="statusBar"
         data-goals-count="{{ goals|length }}"
         data-sessions-count="{{ sessions|length }}"
         data-distractions-count="{{ distractions|length }}">
      <span class="statusDot" aria-hidden="true"></span>
      <span class="statusText" id="statusText">ì˜¤ëŠ˜ì˜ ë‹¤ìŒ í–‰ë™ì„ ì¤€ë¹„ ì¤‘â€¦</span>
      <span class="statusHint" id="statusHint"></span>
    </div>
  </header>

  <main class="wrap grid">
    <!-- íƒ€ì´ë¨¸ -->
    <section class="card" id="cardTimer">
      <div class="cardHead">
        <h2>íƒ€ì´ë¨¸</h2>
        <div class="cardHeadRight">
          <span id="modePill" class="pill">Focus</span>
          <button id="settingsBtn" class="iconBtn" type="button" aria-label="ì„¤ì •">âš™</button>
        </div>
      </div>

      <!-- ì„¤ì •(ë¯¸ë‹ˆë©€) -->
      <div id="settingsPanel" class="settingsPanel hidden">
        <label class="setting">
          <input id="optSound" type="checkbox" />
          ì†Œë¦¬
        </label>
        <label class="setting">
          <input id="optNotify" type="checkbox" />
          ë°ìŠ¤í¬í†± ì•Œë¦¼
        </label>
        <label class="setting">
          <input id="optAutoBreak" type="checkbox" />
          ìë™ íœ´ì‹
        </label>
      </div>

      <div class="timer">
        <div id="timerDisplay" class="timerDisplay">25:00</div>

        <div class="timerButtons">
          <button id="startBtn" class="btn btnPrimary" type="button">Start</button>
          <button id="pauseBtn" class="btn btnGhost" type="button" disabled>Pause</button>
          <button id="finishBtn" class="btn btnGhost" type="button" disabled>Finish</button>
        </div>

        <div class="timerFields">
          <label class="muted">ì§‘ì¤‘(ë¶„)</label>
          <input id="focusMinutes" type="number" min="1" max="180" value="25" />
          <label class="muted">íœ´ì‹(ë¶„)</label>
          <input id="breakMinutes" type="number" min="1" max="60" value="5" />
        </div>
      </div>

      <form id="sessionForm" action="/sessions" method="post" class="hidden">
        <input type="hidden" name="start_ts" id="sessionStartTs" />
        <input type="hidden" name="end_ts" id="sessionEndTs" />
        <input type="hidden" name="minutes" id="sessionMinutes" />
      </form>

      <p class="muted small timerNote">
        0ì´ˆê°€ ë˜ë©´ ìë™ìœ¼ë¡œ ì„¸ì…˜ì´ ê¸°ë¡ëœë‹¤. (ì´ì œ Finish ê¹Œë¨¹ì–´ë„ ëœë‹¤. ğŸ‘Œ)
      </p>
    </section>

    <!-- ì˜¤ëŠ˜ì˜ 3ê°œ ëª©í‘œ -->
    <section class="card" id="cardGoals">
      <div class="cardHead">
        <h2>ì˜¤ëŠ˜ì˜ 3ê°œ ëª©í‘œ</h2>
        <span class="pill">Top 3</span>
      </div>

      <form action="/goals" method="post" class="stack">
        <input id="goal1" name="g1" placeholder="ëª©í‘œ 1" value="{{ goals[0].title if goals|length>0 else '' }}" />
        <input id="goal2" name="g2" placeholder="ëª©í‘œ 2" value="{{ goals[1].title if goals|length>1 else '' }}" />
        <input id="goal3" name="g3" placeholder="ëª©í‘œ 3" value="{{ goals[2].title if goals|length>2 else '' }}" />
        <button class="btn btnSoft btnWide" type="submit">ì €ì¥</button>
      </form>

      <div class="list">
        {% for g in goals %}
          <form action="/goals/{{ g.id }}/toggle" method="post" class="row between goalRow">
            <div class="goalLeft">
              <span class="badge">{{ "DONE" if g.done==1 else "TODO" }}</span>
              <span class="{{ 'done' if g.done==1 else '' }}">{{ g.title }}</span>
            </div>
            <button class="btn btnGhost btnSm" type="submit">{{ "ë˜ëŒë¦¬ê¸°" if g.done==1 else "ì™„ë£Œ" }}</button>
          </form>
        {% endfor %}
        {% if goals|length == 0 %}
          <p class="muted small">ì•„ì§ ëª©í‘œê°€ ì—†ë‹¤. ëª©í‘œ 1ê°œë§Œ ì¨ë„ ìŠ¹ë¦¬ë‹¤.</p>
        {% endif %}
      </div>
    </section>

    <!-- ë°©í•´ìš”ì†Œ ê¸°ë¡ -->
    <section class="card" id="cardDistractions">
      <div class="cardHead">
        <h2>ë°©í•´ìš”ì†Œ ê¸°ë¡</h2>
        <span class="pill">Interrupt</span>
      </div>

      <form action="/distractions" method="post" class="distractionForm">
        <input id="distractionNote" name="note" placeholder="ì˜ˆ: ìŠ¬ë™ í™•ì¸, ìœ íŠœë¸Œ, ê°‘ìê¸° ì²­ì†Œ" maxlength="200" />
        <button class="btn btnSoft btnFixed" type="submit">ê¸°ë¡</button>
      </form>

      <div class="list">
        {% for d in distractions %}
          <div class="row between">
            <span class="muted small mono">{{ d.ts }}</span>
            <span>{{ d.note }}</span>
          </div>
        {% endfor %}
        {% if distractions|length == 0 %}
          <p class="muted small">ì•„ì§ ë°©í•´ìš”ì†Œê°€ ì—†ë‹¤â€¦? ë„ˆ ì˜¤ëŠ˜ ì»¨ë””ì…˜ ì¢‹ì€ë°?</p>
        {% endif %}
      </div>
    </section>

    <!-- ì˜¤ëŠ˜ì˜ ì§‘ì¤‘ ì„¸ì…˜ -->
    <section class="card" id="cardSessions">
      <div class="cardHead">
        <h2>ì˜¤ëŠ˜ì˜ ì§‘ì¤‘ ì„¸ì…˜</h2>
        <span class="pill">Sessions</span>
      </div>

      <div class="list">
        {% for s in sessions %}
          <div class="row between">
            <span class="muted small mono">{{ s.start_ts }} â†’ {{ s.end_ts }}</span>
            <b>{{ s.minutes }}ë¶„</b>
          </div>
        {% endfor %}
        {% if sessions|length == 0 %}
          <p class="muted small">ì„¸ì…˜ì´ ì•„ì§ ì—†ë‹¤. 5ë¶„ë§Œ í•´ë„ ê¸°ë¡í•˜ì.</p>
        {% endif %}
      </div>
    </section>
  </main>

  <script src="/static/app.js"></script>
</body>
</html>
